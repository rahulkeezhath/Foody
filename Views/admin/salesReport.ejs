
  <section class="home-section mt-5">
  <div class="container" id="content">
    <div class="d-flex justify-content-end  p-3">
        <button class="btn btn-success" onclick="generatePDF()">Download</button>
    </div>
          <table id="order-table" class="table table-striped table-bordered">
              <thead class="bg-secondary">
                <tr>
                  <th scope="col text-light">OrderId</th>
                  <th scope="col">Order Date</t>
                  <th scope="col">Customer Details</th>
                  <th scope="col">Order status</th>
                  <th scope="col">Payment Method</th>
                  <th scope="col">Amount</th>
                </tr>
              </thead>
              <tbody id="orderTable">
                  <% for(var i=0;i<salesReport.length;i++) { %>
                <tr>
                                                                                                                                   
                <td  style="border-color: black;"> <%= salesReport[i]._id %></td></a>
                  <td  style="border-color: black;" ><%= salesReport[i].date.toLocaleDateString() %>
                                                       <%= salesReport[i].date.toLocaleTimeString()%></td>
                  <td  style="border-color: black;"><%= salesReport[i].deliveryDetails.address %></td>
                  <td  style="border-color: black;"><%= salesReport[i].status %></td>
                  <td  style="border-color: black;"><%= salesReport[i].paymentMethod %></td>
                  <td  style="border-color: black;"><%= salesReport[i].totalAmount %></td>
                </tr>
                
                <% } %>
              
              </tbody>
            </table>
      
  </div>
</section>

<script>
// File Exporting
function generatePDF() {
      const element = document.getElementById('order-table');
      var opt = {
          margin: 1,
          filename: 'orderReportPdf_example.pdf',
          image: { type: 'png', quality: 0.98 },
          html2canvas: { scale: 2 },
          jsPDF: { unit: 'in', format: 'letter', orientation: 'landscape' }
      };
      // Choose the element that our invoice is rendered in.
      html2pdf().set(opt).from(element).save();
    }
</script>